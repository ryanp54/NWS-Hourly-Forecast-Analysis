(window.webpackJsonpapp=window.webpackJsonpapp||[]).push([[0],{165:function(e,t,a){e.exports=a(297)},170:function(e,t,a){},297:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(76),l=a.n(c),s=(a(170),a(147)),o=a(20),i=a(148),u=a.n(i),m=(a(181),a(303)),p=a(304),d=a(305),y=a(311),f=a(63),b=a(149),E=a(313),g=a(306),h=a(316),v=a(315),O=a(324),j=a(322),k=a(317),x=a(326),S=a(318),N=a(320),C=a(314);function D(e){return e.replace(/_/," ").replace(/(?:(^|\(|"|\s|-|,)\w)\w+/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e}).replace(/(?:^|\(|"|\s|-|,)\w/g,function(e){return e.toUpperCase()})}function w(e){if(!e)return e;var t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function _(e){var t=new Date;return t.setDate(t.getDate()-e),w(t)}function A(e){var t="".concat(e.getMonth()+1,"/").concat(e.getDate()),a=e.toLocaleTimeString().split(/[:\s]/);return e.getHours()?"".concat(a[0]," ").concat(a.slice(-1)):t}function P(e){return e.toISOString().split("T")[0]}function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(a,!0).forEach(function(t){Object(b.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function F(e){var t=e.analysis,a=Object(n.useState)("temperature"),c=Object(o.a)(a,2),l=c[0],s=c[1];return r.a.createElement("div",null,r.a.createElement(m.a,null,r.a.createElement(p.a,null,r.a.createElement(d.a,null,r.a.createElement(E.a,{justify:!0,className:"h6",activeKey:l,onSelect:function(e){return s(e)}},["temperature","dewpoint","wind_speed","cloud_cover","precip_chance"].map(function(e){return r.a.createElement(g.a,{className:"align-center",eventKey:e,title:Object.keys(t).includes(e)?t[e].metadata.display_name:D(e),key:e,disabled:!Object.keys(t).includes(e)})}))))),r.a.createElement(M,{analysis:t[l]}))}function M(e){var t,a,c=e.analysis,l=Object(n.useState)([]),s=Object(o.a)(l,2),i=s[0],u=s[1],y=Object(n.useCallback)(u,[]);return Object(n.useEffect)(function(){return u([])},[c]),"precip_chance"===c.metadata.prop_name?(t=r.a.createElement(T,{analysis:c,onCursorChange:y}),a=r.a.createElement(U,{displayInfo:z({},c.metadata,{},{units:{x:c.metadata.units,y:""}}),data:i})):(t=r.a.createElement(H,{analysis:c,onCursorChange:y}),a=r.a.createElement(U,{displayInfo:c.metadata,data:i})),r.a.createElement(d.a,null,r.a.createElement(I,null,t),r.a.createElement(m.a,null,r.a.createElement(p.a,null,r.a.createElement(d.a,{xs:11,style:{minHeight:"75px"}},a))))}function I(e){var t=e.children;return r.a.createElement("div",{style:{minWidth:"335px",maxWidth:"970px",marginLeft:"auto",marginRight:"auto"}},t)}var H=r.a.memo(function(e){var t=e.analysis,a=e.onCursorChange,c=Object(n.useState)(null),l=Object(o.a)(c,2),s=l[0],i=l[1],u=R(t,s),m=function(e,t){var a=[],n=R(e,t);a.push(r.a.createElement(x.a,{displayName:"Forecast",key:"Forecast",color:"red"},n.map(function(t,a){return r.a.createElement(S.a,{displayName:"".concat(t,"-Day"),name:"".concat(t,"-Day"),key:t,data:Object.entries(e.lead_days[t].fcasts),x:function(e){return new Date(e[0])},y:1,style:{data:{opacity:a>=1?(8-a)/10:1}}})}))),a.push(r.a.createElement(x.a,{displayName:"Actual",key:"Actual",color:"black"},r.a.createElement(S.a,{displayName:"Actual",name:"Actual",data:Object.entries(e.obs),x:function(e){return new Date(e[0])},y:1})));var c=[];t&&(c=Object.entries(e.lead_days[t].errors).reduce(function(a,n){var r=Object(o.a)(n,2),c=r[0],l=r[1],s=new Date(c),i={x:s,y:e.lead_days[t].fcasts[c],y0:e.obs[c],amount:l},u=a.length>0&&a[a.length-1];return u&&u.slice(-1)[0].x.valueOf()===s.valueOf()-36e5?u.push(i):a.push([i]),a},[]).map(function(e,t){return r.a.createElement(N.a,{displayName:"Error-Area-".concat(t),key:"Error-Area-".concat(t),name:"Error-Area-".concat(t),data:e})}));return a.push(r.a.createElement(x.a,{displayName:"Error",key:"Error",style:{data:{opacity:.4,fill:"magenta",stroke:"magenta"},legendSymbol:{type:"square"}}},c)),a}(t,s),y=function(e,t){var a=[],n=t.find(function(e){return"Forecast"===e.props.displayName}),r=t.filter(function(e){return"Forecast"!==e.props.displayName});return a.push.apply(a,Object(f.a)(Object.keys(e.lead_days).map(function(e){var t="".concat(e,"-Day"),a=n.props.children.find(function(e){return e.props.name===t}),r=a&&z({},a.props.theme.line.style,{},a.props.style);return{name:"".concat(e,"-Day"),symbol:{opacity:a?r.data.opacity:.1,fill:n.props.color,cursor:"pointer"},labels:{opacity:a?1:.2,cursor:"pointer"}}}))),a.push.apply(a,Object(f.a)(r.map(function(e){var t=z({},e.props.theme.line.style,{},e.props.style),a=0!==e.props.children.length;return{name:e.props.displayName,symbol:{opacity:a?t.data.opacity:.2,fill:t.data.stroke,cursor:"pointer",type:t.legendSymbol&&t.legendSymbol.type?t.legendSymbol.type:"circle"},labels:{opacity:a?1:.2,cursor:"pointer"}}}))),a}(t,m);return r.a.createElement(p.a,{className:"pt-3"},r.a.createElement(d.a,{xs:12,className:"w-100"},r.a.createElement(B,{activeDay:s,analysis:t})),r.a.createElement(d.a,{xs:12,className:"w-100"},r.a.createElement(h.a,{scale:{x:"time"},domainPadding:{y:20},padding:{top:25,bottom:50,left:50,right:75},containerComponent:r.a.createElement(v.a,{voronoiDimension:"x",labels:function(){return null},labelComponent:r.a.createElement(q,null),onActivated:function(e){return a(e)}})},r.a.createElement(O.a,{tickCount:6,tickFormat:A,style:{ticks:{stroke:"black",size:5},tickLabels:{fontSize:12},grid:{stroke:"grey"}},offsetY:50}),r.a.createElement(O.a,{dependentAxis:!0,crossAxis:!1,axisLabelComponent:r.a.createElement(j.a,{dx:-15,angle:0}),label:t.metadata.units,style:{grid:{stroke:"grey"},tickLabels:{fontSize:12}}}),r.a.createElement(k.a,{data:y,events:[{eventHandlers:{onClick:function(e,n){n&&n.datum&&function(e){var n=Object.keys(t.lead_days),r=e.split("-Day"),c=Object(o.a)(r,1)[0];!s&&e.includes("Error")?i(u[0]):s&&u.includes(c)||!n.includes(c)?("Actual"===e||u.includes(c))&&i(null):i(c),a([])}(n.datum.name)}}}],x:25,y:10,orientation:"horizontal",borderPadding:{top:0,bottom:0,left:5,right:0},gutter:10,symbolSpacer:5,style:{labels:{fontSize:9}}}),m)))});function R(e,t){return t?[t]:Object.keys(e.lead_days)}function q(e){var t=e.x,a=e.scale.y.range();return r.a.createElement("line",{style:{stroke:"lightgrey",strokeWidth:1},x1:t,x2:t,y1:Math.max.apply(Math,Object(f.a)(a)),y2:Math.min.apply(Math,Object(f.a)(a))})}function B(e){var t=e.analysis,a=e.activeDay,n=a?"".concat(a,"-Day"):"Cumulative",c=a?t.lead_days[a].stats:t.cumulative_stats;return r.a.createElement(m.a,null,r.a.createElement(p.a,{className:"d-flex justify-content-center"},r.a.createElement("h5",null,"Forecast Accuracy: ".concat(n))),r.a.createElement(p.a,{className:"d-flex justify-content-center"},Object.keys(c).map(function(e){return Object.keys(c[e]).map(function(a){return!!e.includes(a)&&r.a.createElement(J,{label:e,value:c[e][a],units:t.metadata.units,key:a})})}).flat().filter(Boolean)))}function U(e){var t=e.displayInfo,a=e.data;if(!a||0===a.length)return"";var n=t.units;n&&Object.getPrototypeOf(n)===Object.prototype||(n={x:n,y:n});var c=t.display_name||"",l="";if(a[0]._x instanceof Date){var s=a[0]._x.toLocaleString({dateStyle:"short",timeStyle:"short"}).split(","),i=Object(o.a)(s,2),u=i[0],m=i[1];l="".concat(c&&" on ").concat(u," at ").concat(m)}else l="".concat(c&&": ").concat(a[0][0]," ").concat(n.x);c="".concat(c).concat(l);var y,f=[];return a.forEach(function(e){null!==e._y&&(e.childName.includes("Error")?y=r.a.createElement(J,{label:"Forecast Error",value:e.amount,units:n.y,key:"Forecast Error",className:"text-danger"}):f.push(r.a.createElement(J,{label:e.childName,value:e._y,units:n.y,key:e.childName})))}),y&&f.push(y),r.a.createElement(d.a,{className:"h6 font-weight-normal"},r.a.createElement(p.a,{className:"pb-2"},c),r.a.createElement(p.a,null,f))}function J(e){var t,a=e.label,n=e.value,c=e.units,l=e.type,s=e.className,o=function(e,t){return"".concat(Math.round(10*e)/10," ").concat(t)};return t="accuracy"===(l||a).toLowerCase()?o(100*n,"%"):o(n,c),r.a.createElement("span",{className:"mr-3 d-inline-block ".concat(s)},r.a.createElement("span",null," ",D(a),": "),r.a.createElement("span",{className:"font-weight-light ml-2"}," ",t," "))}var T=r.a.memo(function(e){var t=e.analysis,a=e.onCursorChange,c=Object(n.useState)(null),l=Object(o.a)(c,2),s=l[0],i=l[1],u=s?t.lead_days[s].stats:t.cumulative_stats,d=Object.entries(u.bin_count.bins),y=Object.keys(t.lead_days).map(function(e){return{name:"".concat(e,"-Day"),symbol:{opacity:s===e?1:.2,fill:"darkblue",type:"square",cursor:"pointer"},labels:{opacity:s===e?1:.3,cursor:"pointer"}}});return y.push({name:"Cumulative",symbol:{opacity:s?.2:1,fill:"darkblue",type:"square",cursor:"pointer"},labels:{opacity:s?.3:1,cursor:"pointer"}}),y.push({name:"Expected",symbol:{fill:"lightblue",type:"square"}}),r.a.createElement(m.a,{className:"pt-3"},r.a.createElement(p.a,{className:"d-flex justify-content-center"},r.a.createElement("h5",null,"Precipitation Chance Bin Counts")),r.a.createElement(p.a,{className:"d-flex justify-content-center"},r.a.createElement(J,{label:"Bias",value:u.bin_count.bias,units:"%"})),r.a.createElement(p.a,null,r.a.createElement(h.a,{padding:{top:25,bottom:50,left:50,right:75},containerComponent:r.a.createElement(v.a,{voronoiDimension:"x",labels:function(){return null},labelComponent:r.a.createElement(q,null),onActivated:function(e){return a(e)}})},r.a.createElement(k.a,{x:15,y:5,orientation:"horizontal",borderPadding:{top:0,bottom:0,left:5,right:0},gutter:10,symbolSpacer:5,style:{labels:{fontSize:9}},data:y,events:[{eventHandlers:{onClick:function(e,t,n,r){t&&t.datum&&function(e){var t="Cumulative"===e?[null]:e.split("-Day"),n=Object(o.a)(t,1)[0];s!==n&&"Expected"!==n&&i(n),a([])}(t.datum.name)}}}]}),r.a.createElement(O.a,{style:{ticks:{stroke:"black",size:5},tickLabels:{fontSize:12},grid:{stroke:"grey"}},label:"Forecasted chance of pricipitation (%)",offsetY:50,axisLabelComponent:r.a.createElement(j.a,{dy:5,style:{fontSize:11}})}),r.a.createElement(O.a,{dependentAxis:!0,crossAxis:!1,style:{grid:{stroke:"grey"},tickLabels:{fontSize:12}},label:"Number of precipitation observations",axisLabelComponent:r.a.createElement(j.a,{dy:-5,angle:-90,style:{fontSize:11}})}),r.a.createElement(x.a,{colorScale:["darkblue","lightblue"],offset:5},r.a.createElement(C.a,{name:"Observed occurances",data:d,x:0,y:[1,"obs"]}),r.a.createElement(C.a,{name:"Predicted occurances",data:d,x:0,y:[1,"predicted"]})))))}),W=_(8),K=_(1),Y=new Date(2019,0,24),X=_(1),G=14,Q=864e5;function V(e){var t=e.handleSubmit,a=Object(n.useState)(W),c=Object(o.a)(a,2),l=c[0],s=c[1],i=Object(n.useState)(K),u=Object(o.a)(i,2),f=u[0],b=u[1],E=w(new Date(f))-w(new Date(l)),g="";return null===l||null===f?g="Data not available for all selected dates.":l?f?f<=l?g="Start date must be before end date.":E>=G*Q&&(g="Date range must be less than ".concat(G," days.")):g="Select valid end date.":g="Select valid start date.",r.a.createElement(m.a,null,r.a.createElement(p.a,{className:"justify-content-center"},r.a.createElement(d.a,{xs:"auto"},r.a.createElement(Z,{label:"Start",value:l,onChange:s})),r.a.createElement(d.a,{xs:"auto"},r.a.createElement(Z,{label:"End",value:f,onChange:b})),r.a.createElement(d.a,{md:2,className:"d-flex align-self-center justify-content-center mt-3"},r.a.createElement(y.a,{disabled:g,onClick:function(){g||t(l,f)}},"Submit"))),r.a.createElement(p.a,null,r.a.createElement(d.a,{className:"py-1"},r.a.createElement("span",{className:"text-center text-danger position-absolute w-100"},g))))}function Z(e){var t=e.label,a=e.onChange,n=Object(s.a)(e,["label","onChange"]),c={before:Y,after:X};return r.a.createElement(d.a,{className:"pb-3"},r.a.createElement(p.a,null,r.a.createElement(d.a,null,r.a.createElement("label",null,"".concat(t,":")))),r.a.createElement(p.a,null,r.a.createElement(d.a,null,r.a.createElement(u.a,Object.assign({},n,{onDayChange:function(e,t){a(t.disabled?null:w(e))},dayPickerProps:{disabledDays:c}})))))}function $(e){var t=e.message;return r.a.createElement(m.a,{className:"py-5 pl-4"},r.a.createElement(p.a,{className:"justify-content-center"},r.a.createElement(d.a,{xs:5,md:3,lg:2},t)))}l.a.render(r.a.createElement(function(e){var t=e.apiURL,a=e.initialData,c=void 0!==a&&a,l=Object(n.useState)(JSON.parse(c)),s=Object(o.a)(l,2),i=s[0],u=s[1],m=Object(n.useState)("Select date range."),p=Object(o.a)(m,2),d=p[0],y=p[1],f=function(e,a){y("Retrieving. . ."),u(null);var n=setInterval(function(){y(function(e){return e.includes(". . .")?"Retrieving":"".concat(e," .")})},500);fetch("".concat(t,"start=").concat(P(e),"&end=").concat(P(a))).then(function(e){return e.json()}).then(function(e){y(""),u(e)}).catch(function(e){return y(e.message)}).finally(function(){return clearInterval(n)})};return Object(n.useEffect)(function(){c||f(W,K)},[]),r.a.createElement("div",null,r.a.createElement("div",{className:"pt-2 pb-4"},r.a.createElement(V,{handleSubmit:f})),r.a.createElement("div",{className:"pt-2"},i?r.a.createElement(F,{analysis:i}):r.a.createElement($,{message:d})))},{apiURL:"/OAX/forecasts/analyze?",initialData:window.CACHED_DATA}),document.getElementById("root"))}},[[165,1,2]]]);
//# sourceMappingURL=main.84dfeb0d.chunk.js.map